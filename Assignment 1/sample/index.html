<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ER/EER Diagram Builder Pro</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* === CSS Variables === */
        :root {
            /* Colors */
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --primary-light: #8b5cf6;
            --secondary: #10b981;
            --secondary-dark: #059669;
            --accent: #f59e0b;
            --accent-dark: #d97706;
            --danger: #ef4444;
            --danger-dark: #dc2626;
            --warning: #f59e0b;
            --info: #06b6d4;
            
            /* Dark Theme */
            --dark-1: #0f172a;
            --dark-2: #1e293b;
            --dark-3: #334155;
            --dark-4: #475569;
            
            /* Light Theme */
            --light-1: #f8fafc;
            --light-2: #f1f5f9;
            --light-3: #e2e8f0;
            --light-4: #cbd5e1;
            
            /* Glass Effects */
            --glass-bg: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
            --glass-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            --glass-blur: blur(20px);
            
            /* Shadows */
            --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.1);
            --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.15);
            --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.2);
            --shadow-xl: 0 16px 64px rgba(0, 0, 0, 0.3);
            
            /* Border Radius */
            --radius-sm: 8px;
            --radius-md: 16px;
            --radius-lg: 24px;
            --radius-xl: 32px;
            
            /* Transitions */
            --transition-fast: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-normal: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            
            /* Spacing */
            --space-xs: 0.5rem;
            --space-sm: 1rem;
            --space-md: 1.5rem;
            --space-lg: 2rem;
            --space-xl: 3rem;
        }

        /* === Dark/Light Theme Variables === */
        .dark-mode {
            --bg-primary: var(--dark-1);
            --bg-secondary: var(--dark-2);
            --bg-tertiary: var(--dark-3);
            --text-primary: var(--light-1);
            --text-secondary: var(--light-2);
            --text-muted: var(--light-3);
            --border-color: rgba(255, 255, 255, 0.1);
            --hover-color: rgba(255, 255, 255, 0.05);
        }

        .light-mode {
            --bg-primary: var(--light-1);
            --bg-secondary: var(--light-2);
            --bg-tertiary: var(--light-3);
            --text-primary: var(--dark-1);
            --text-secondary: var(--dark-2);
            --text-muted: var(--dark-3);
            --border-color: rgba(0, 0, 0, 0.1);
            --hover-color: rgba(0, 0, 0, 0.05);
        }

        /* === Base Styles === */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
            min-height: 100vh;
            transition: var(--transition-slow);
        }

        /* === Animated Background === */
        .animated-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(99, 102, 241, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(16, 185, 129, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(245, 158, 11, 0.05) 0%, transparent 50%);
            animation: bgFloat 20s ease-in-out infinite;
            z-index: -1;
        }

        @keyframes bgFloat {
            0%, 100% { transform: translate(0, 0) scale(1); }
            25% { transform: translate(-10px, -10px) scale(1.02); }
            50% { transform: translate(5px, 5px) scale(1.01); }
            75% { transform: translate(10px, -5px) scale(1.03); }
        }

        /* === Glass Effect === */
        .glass {
            background: var(--glass-bg);
            backdrop-filter: var(--glass-blur);
            -webkit-backdrop-filter: var(--glass-blur);
            border: 1px solid var(--glass-border);
            box-shadow: var(--glass-shadow);
        }

        /* === Header === */
        header {
            position: sticky;
            top: 0;
            z-index: 1000;
            padding: var(--space-md) var(--space-lg);
            margin: var(--space-md);
            border-radius: var(--radius-lg);
            animation: slideDown 0.6s ease;
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: var(--space-md);
        }

        .logo-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
            animation: pulse 2s infinite;
        }

        .logo-text h1 {
            font-size: 1.8rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--text-primary), var(--primary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .logo-text p {
            font-size: 0.9rem;
            color: var(--text-muted);
            margin-top: 2px;
        }

        .header-controls {
            display: flex;
            gap: var(--space-sm);
        }

        /* === Main Container === */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 var(--space-lg);
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: var(--space-lg);
            min-height: calc(100vh - 200px);
        }

        /* === Toolbar === */
        .toolbar {
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            display: flex;
            flex-direction: column;
            gap: var(--space-lg);
            animation: slideInLeft 0.6s ease;
        }

        .tool-section {
            display: flex;
            flex-direction: column;
            gap: var(--space-md);
        }

        .section-header {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            color: var(--text-primary);
        }

        .section-header i {
            color: var(--primary);
            font-size: 1.1rem;
        }

        .section-header h3 {
            font-size: 1rem;
            font-weight: 600;
        }

        .tool-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--space-sm);
        }

        .tool-btn {
            background: var(--bg-tertiary);
            border: 2px solid transparent;
            border-radius: var(--radius-md);
            padding: var(--space-md);
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--space-xs);
            transition: var(--transition-normal);
            position: relative;
            overflow: hidden;
        }

        .tool-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.6s;
        }

        .tool-btn:hover::before {
            left: 100%;
        }

        .tool-btn:hover {
            transform: translateY(-4px) scale(1.02);
            border-color: var(--primary);
            box-shadow: var(--shadow-lg);
        }

        .tool-btn.active {
            background: var(--primary);
            color: white;
            transform: scale(1.02);
        }

        .tool-icon {
            width: 40px;
            height: 40px;
            background: var(--bg-secondary);
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            transition: var(--transition-normal);
            position: relative;
        }

        .tool-btn:hover .tool-icon {
            background: var(--primary);
            color: white;
            transform: scale(1.1) rotate(5deg);
        }

        .weak-overlay {
            position: absolute;
            bottom: 2px;
            right: 2px;
            font-size: 0.8rem;
            color: var(--accent);
        }

        .tool-btn span {
            font-size: 0.8rem;
            font-weight: 500;
            text-align: center;
        }

        /* === Action Buttons === */
        .action-grid {
            display: flex;
            flex-direction: column;
            gap: var(--space-sm);
        }

        .action-btn {
            border: none;
            border-radius: var(--radius-md);
            padding: var(--space-md);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            font-weight: 600;
            transition: var(--transition-normal);
            position: relative;
            overflow: hidden;
        }

        .action-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .action-btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .action-btn.primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
        }

        .action-btn.secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .action-btn.success {
            background: linear-gradient(135deg, var(--secondary), var(--secondary-dark));
            color: white;
        }

        .action-btn.accent {
            background: linear-gradient(135deg, var(--accent), var(--accent-dark));
            color: white;
        }

        .action-btn.danger {
            background: linear-gradient(135deg, var(--danger), var(--danger-dark));
            color: white;
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        /* === Statistics === */
        .stats-grid {
            display: flex;
            flex-direction: column;
            gap: var(--space-sm);
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            padding: var(--space-md);
            background: var(--bg-tertiary);
            border-radius: var(--radius-md);
            transition: var(--transition-normal);
        }

        .stat-item:hover {
            transform: translateX(4px);
            background: var(--hover-color);
        }

        .stat-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1rem;
        }

        .stat-info {
            display: flex;
            flex-direction: column;
        }

        .stat-value {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--primary);
        }

        .stat-label {
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        /* === Workspace === */
        .workspace-container {
            border-radius: var(--radius-lg);
            overflow: hidden;
            position: relative;
            animation: slideInRight 0.6s ease;
        }

        .workspace-controls {
            position: absolute;
            top: var(--space-md);
            right: var(--space-md);
            display: flex;
            flex-direction: column;
            gap: var(--space-sm);
            z-index: 100;
        }

        .control-group {
            display: flex;
            gap: var(--space-sm);
        }

        .control-btn {
            border: none;
            border-radius: var(--radius-md);
            padding: var(--space-sm);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition-normal);
            color: var(--text-primary);
            min-width: 40px;
            min-height: 40px;
        }

        .control-btn:hover {
            transform: scale(1.1);
            background: var(--primary);
            color: white;
        }

        .control-btn.active {
            background: var(--primary);
            color: white;
        }

        .zoom-display {
            padding: var(--space-sm) var(--space-md);
            border-radius: var(--radius-md);
            font-size: 0.9rem;
            font-weight: 600;
            text-align: center;
        }

        .workspace {
            width: 100%;
            height: 700px;
            position: relative;
            overflow: hidden;
            cursor: grab;
            background: 
                linear-gradient(var(--border-color) 1px, transparent 1px),
                linear-gradient(90deg, var(--border-color) 1px, transparent 1px);
            background-size: 20px 20px;
            transition: var(--transition-normal);
        }

        .workspace.dragging {
            cursor: grabbing;
        }

        .workspace.connecting {
            cursor: crosshair;
        }

        /* === Workspace Info === */
        .workspace-info {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            color: var(--text-muted);
            max-width: 500px;
            animation: fadeIn 1s ease;
        }

        .info-graphic {
            position: relative;
            margin-bottom: var(--space-lg);
        }

        .graphic-element {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: white;
            margin: 0 auto;
            animation: float 3s ease-in-out infinite;
            position: relative;
            z-index: 2;
        }

        .graphic-orbits {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .orbit {
            position: absolute;
            border: 2px solid var(--primary);
            border-radius: 50%;
            animation: orbit 4s linear infinite;
        }

        .orbit:nth-child(1) {
            width: 120px;
            height: 120px;
            top: -20px;
            left: -20px;
            animation-delay: 0s;
        }

        .orbit:nth-child(2) {
            width: 160px;
            height: 160px;
            top: -40px;
            left: -40px;
            animation-delay: -1s;
        }

        .orbit:nth-child(3) {
            width: 200px;
            height: 200px;
            top: -60px;
            left: -60px;
            animation-delay: -2s;
        }

        @keyframes orbit {
            0% { transform: translate(-50%, -50%) rotate(0deg); }
            100% { transform: translate(-50%, -50%) rotate(360deg); }
        }

        .workspace-info h2 {
            font-size: 2rem;
            margin-bottom: var(--space-sm);
            color: var(--text-primary);
            background: linear-gradient(135deg, var(--text-primary), var(--primary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .workspace-info p {
            font-size: 1.1rem;
            margin-bottom: var(--space-lg);
        }

        .info-features {
            display: flex;
            flex-direction: column;
            gap: var(--space-md);
        }

        .feature {
            display: flex;
            align-items: center;
            gap: var(--space-md);
            padding: var(--space-md);
            background: var(--glass-bg);
            border-radius: var(--radius-md);
            backdrop-filter: var(--glass-blur);
        }

        .feature i {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--secondary), var(--secondary-dark));
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
        }

        .feature div {
            text-align: left;
        }

        .feature strong {
            display: block;
            color: var(--text-primary);
            margin-bottom: 2px;
        }

        .feature span {
            font-size: 0.9rem;
            color: var(--text-muted);
        }

        /* === Connection Layer === */
        .connection-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        /* === Entity Styles === */
        .entity {
            position: absolute;
            width: 200px;
            background: var(--bg-secondary);
            border: 2px solid var(--primary);
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-lg);
            cursor: move;
            user-select: none;
            transition: var(--transition-normal);
            z-index: 10;
            backdrop-filter: var(--glass-blur);
            animation: flipIn 0.6s ease;
        }

        .entity:hover {
            transform: scale(1.05) rotate(1deg);
            box-shadow: var(--shadow-xl), 0 0 30px rgba(99, 102, 241, 0.4);
            z-index: 100;
        }

        .entity.weak-entity {
            border-style: double;
            border-width: 4px;
            border-color: var(--accent);
        }

        .entity.selected {
            border-color: var(--secondary);
            box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.3);
        }

        .entity-header {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            padding: var(--space-md);
            border-radius: var(--radius-md) var(--radius-md) 0 0;
            text-align: center;
            font-weight: 600;
            font-size: 1rem;
            position: relative;
        }

        .entity-actions {
            position: absolute;
            top: var(--space-xs);
            right: var(--space-xs);
            display: flex;
            gap: 4px;
            opacity: 0;
            transition: var(--transition-fast);
        }

        .entity:hover .entity-actions {
            opacity: 1;
        }

        .entity-action {
            width: 24px;
            height: 24px;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            border-radius: 4px;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            transition: var(--transition-fast);
        }

        .entity-action:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        .entity-attributes {
            padding: var(--space-md);
        }

        .attribute {
            padding: var(--space-sm) 0;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: var(--space-xs);
            border-bottom: 1px solid var(--border-color);
            position: relative;
        }

        .attribute:last-child {
            border-bottom: none;
        }

        .attribute.key {
            font-weight: 700;
            color: var(--accent);
        }

        .attribute.key::before {
            content: "🔑";
            margin-right: 4px;
        }

        .attribute.derived::after {
            content: " (D)";
            font-style: italic;
            color: var(--info);
        }

        .attribute.multivalued::after {
            content: " {M}";
            color: var(--danger);
            font-weight: 600;
        }

        .attribute.composite {
            font-weight: 600;
            color: var(--secondary);
        }

        .connection-points {
            position: absolute;
            top: -6px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 4px;
        }

        .connection-dot {
            width: 12px;
            height: 12px;
            background: var(--secondary);
            border-radius: 50%;
            cursor: crosshair;
            transition: var(--transition-normal);
            border: 2px solid var(--bg-secondary);
        }

        .connection-dot:hover {
            transform: scale(1.5);
            background: var(--accent);
            box-shadow: 0 0 10px var(--accent);
        }

        /* === Relationship Styles === */
        .relationship {
            position: absolute;
            min-width: 120px;
            height: 60px;
            background: linear-gradient(135deg, var(--secondary), var(--secondary-dark));
            color: white;
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            box-shadow: var(--shadow-lg);
            cursor: move;
            user-select: none;
            transition: var(--transition-normal);
            z-index: 10;
            backdrop-filter: var(--glass-blur);
            animation: flipIn 0.6s ease;
            padding: 0 var(--space-md);
            text-align: center;
        }

        .relationship:hover {
            transform: scale(1.1) rotate(2deg);
            box-shadow: var(--shadow-xl), 0 0 30px rgba(16, 185, 129, 0.4);
            z-index: 100;
        }

        .relationship.isa-relationship {
            background: linear-gradient(135deg, var(--info), #0ea5e9);
            font-style: italic;
            border-radius: 30px;
        }

        .relationship.identifying {
            background: linear-gradient(135deg, var(--accent), var(--accent-dark));
        }

        .relationship.selected {
            box-shadow: 0 0 0 3px rgba(245, 158, 11, 0.3);
        }

        /* === Schema Panel === */
        .schema-panel {
            position: fixed;
            top: 0;
            right: -400px;
            width: 400px;
            height: 100vh;
            box-shadow: var(--shadow-xl);
            transition: var(--transition-normal);
            z-index: 2000;
            display: flex;
            flex-direction: column;
        }

        .schema-panel.open {
            right: 0;
        }

        .schema-header {
            padding: var(--space-lg);
            background: linear-gradient(135deg, var(--dark-2), var(--dark-3));
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .schema-title {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .schema-controls {
            display: flex;
            gap: var(--space-sm);
        }

        .schema-content {
            flex: 1;
            padding: var(--space-lg);
            overflow-y: auto;
        }

        .table-schema {
            background: var(--bg-tertiary);
            border-radius: var(--radius-md);
            padding: var(--space-lg);
            margin-bottom: var(--space-md);
            box-shadow: var(--shadow-sm);
            transition: var(--transition-normal);
            animation: slideInUp 0.4s ease;
        }

        .table-schema:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .table-name {
            font-weight: 700;
            color: var(--primary);
            margin-bottom: var(--space-md);
            padding-bottom: var(--space-sm);
            border-bottom: 2px solid var(--primary);
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: var(--space-xs);
        }

        .attribute-schema {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--space-sm) 0;
            border-bottom: 1px solid var(--border-color);
            font-size: 0.9rem;
        }

        .attribute-schema:last-child {
            border-bottom: none;
        }

        .attribute-schema.pk {
            font-weight: 700;
            color: var(--accent);
        }

        .attribute-schema.fk {
            color: var(--secondary);
            font-style: italic;
        }

        .constraints {
            font-size: 0.8rem;
            color: var(--text-muted);
            background: var(--bg-secondary);
            padding: 2px 6px;
            border-radius: 4px;
        }

        /* === Modal Styles === */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(10px);
            z-index: 3000;
            align-items: center;
            justify-content: center;
            padding: var(--space-lg);
            animation: modalFadeIn 0.3s ease;
        }

        .modal.open {
            display: flex;
        }

        .modal-content {
            border-radius: var(--radius-lg);
            width: 100%;
            max-width: 500px;
            max-height: 90vh;
            overflow: hidden;
            transform: scale(0.9);
            animation: modalSlideIn 0.3s ease forwards;
        }

        .modal-header {
            padding: var(--space-lg);
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .modal-body {
            padding: var(--space-lg);
            max-height: 60vh;
            overflow-y: auto;
        }

        .modal-footer {
            padding: var(--space-lg);
            background: var(--bg-tertiary);
            display: flex;
            justify-content: flex-end;
            gap: var(--space-sm);
        }

        /* === Form Styles === */
        .form-group {
            margin-bottom: var(--space-lg);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--space-md);
        }

        .form-group label {
            display: block;
            margin-bottom: var(--space-sm);
            font-weight: 600;
            color: var(--text-primary);
        }

        input[type="text"], select {
            width: 100%;
            padding: var(--space-md);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            background: var(--bg-tertiary);
            color: var(--text-primary);
            font-size: 1rem;
            transition: var(--transition-normal);
        }

        input[type="text"]:focus, select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
            transform: translateY(-2px);
        }

        /* === Button Styles === */
        .btn {
            border: none;
            padding: var(--space-md) var(--space-lg);
            border-radius: var(--radius-md);
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition-normal);
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .btn.primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
        }

        .btn.secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .close-btn {
            border: none;
            width: 32px;
            height: 32px;
            border-radius: var(--radius-sm);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition-normal);
            color: var(--text-primary);
        }

        .close-btn:hover {
            background: var(--danger);
            color: white;
            transform: rotate(90deg);
        }

        /* === Checkbox Styles === */
        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: var(--space-md);
        }

        .checkbox {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            cursor: pointer;
            font-weight: 500;
        }

        .checkbox input {
            display: none;
        }

        .checkmark {
            width: 20px;
            height: 20px;
            border: 2px solid var(--border-color);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition-normal);
            position: relative;
        }

        .checkbox input:checked + .checkmark {
            background: var(--primary);
            border-color: var(--primary);
        }

        .checkbox input:checked + .checkmark::after {
            content: '✓';
            color: white;
            font-size: 0.8rem;
            font-weight: bold;
        }

        /* === List Styles === */
        .attributes-list, .sub-attributes-list {
            display: flex;
            flex-direction: column;
            gap: var(--space-sm);
            max-height: 200px;
            overflow-y: auto;
            margin-bottom: var(--space-md);
        }

        .attribute-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--space-md);
            background: var(--bg-tertiary);
            border-radius: var(--radius-md);
            border: 1px solid var(--border-color);
            transition: var(--transition-normal);
        }

        .attribute-item:hover {
            transform: translateX(4px);
            border-color: var(--primary);
        }

        .delete-attr {
            color: var(--danger);
            cursor: pointer;
            padding: var(--space-xs);
            border-radius: var(--radius-sm);
            transition: var(--transition-normal);
        }

        .delete-attr:hover {
            background: var(--danger);
            color: white;
            transform: scale(1.1);
        }

        .add-btn {
            border: 2px dashed var(--border-color);
            padding: var(--space-md);
            border-radius: var(--radius-md);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            width: 100%;
            justify-content: center;
            transition: var(--transition-normal);
            color: var(--text-muted);
            background: transparent;
        }

        .add-btn:hover {
            border-color: var(--primary);
            color: var(--primary);
            transform: translateY(-2px);
        }

        /* === Context Menu === */
        .context-menu {
            position: fixed;
            display: none;
            flex-direction: column;
            border-radius: var(--radius-md);
            padding: var(--space-sm);
            z-index: 4000;
            animation: contextMenuIn 0.2s ease;
        }

        .context-menu.open {
            display: flex;
        }

        .context-item {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            padding: var(--space-sm) var(--space-md);
            cursor: pointer;
            border-radius: var(--radius-sm);
            transition: var(--transition-fast);
        }

        .context-item:hover {
            background: var(--hover-color);
        }

        .context-item i {
            width: 16px;
            text-align: center;
        }

        .context-item[data-action="delete"] {
            color: var(--danger);
        }

        /* === Notification System === */
        .notification-container {
            position: fixed;
            top: var(--space-lg);
            right: var(--space-lg);
            z-index: 5000;
            display: flex;
            flex-direction: column;
            gap: var(--space-sm);
        }

        .notification {
            padding: var(--space-md) var(--space-lg);
            border-radius: var(--radius-md);
            color: white;
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            animation: notificationIn 0.3s ease;
            backdrop-filter: var(--glass-blur);
            box-shadow: var(--shadow-lg);
            min-width: 300px;
        }

        .notification.success {
            background: linear-gradient(135deg, var(--secondary), var(--secondary-dark));
        }

        .notification.error {
            background: linear-gradient(135deg, var(--danger), var(--danger-dark));
        }

        .notification.warning {
            background: linear-gradient(135deg, var(--warning), var(--accent-dark));
        }

        .notification.info {
            background: linear-gradient(135deg, var(--info), #0ea5e9);
        }

        .notification.out {
            animation: notificationOut 0.3s ease forwards;
        }

        /* === Footer === */
        footer {
            margin: var(--space-lg);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            animation: slideUp 0.6s ease;
        }

        .footer-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .footer-info p {
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        .footer-links {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            color: var(--text-muted);
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        /* Add to styles.css */
        .connection-line {
            stroke: #6366f1;
            stroke-width: 2;
            marker-end: url(#arrowhead);
        }

        .connection-line.total {
            stroke-dasharray: none;
        }

        .connection-line.partial {
            stroke-dasharray: 5,5;
        }

        .cardinality-label {
            font-size: 12px;
            font-weight: bold;
            fill: #6366f1;
            background: rgba(255, 255, 255, 0.9);
            padding: 2px 6px;
            border-radius: 4px;
        }

        /* Make relationships more visible */
        .relationship {
            min-width: 120px;
            height: 60px;
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            cursor: move;
            z-index: 10;
            backdrop-filter: blur(20px);
            animation: flipIn 0.6s ease;
            padding: 0 20px;
            text-align: center;
            font-size: 14px;
            border: 2px solid white;
        }

        .relationship.isa-relationship {
            background: linear-gradient(135deg, #06b6d4, #0ea5e9);
            font-style: italic;
            border-radius: 30px;
        }

        .relationship.identifying {
            background: linear-gradient(135deg, #f59e0b, #d97706);
        }

        .relationship:hover {
            transform: scale(1.1);
            box-shadow: 0 12px 48px rgba(0, 0, 0, 0.3), 0 0 30px rgba(16, 185, 129, 0.4);
            z-index: 100;
        }

        /* === Animations === */
        @keyframes slideDown {
            from {
                transform: translateY(-100%);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        @keyframes slideInLeft {
            from {
                transform: translateX(-100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slideUp {
            from {
                transform: translateY(100%);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        @keyframes slideInUp {
            from {
                transform: translateY(30px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        @keyframes flipIn {
            from {
                opacity: 0;
                transform: rotateY(90deg) scale(0.8);
            }
            to {
                opacity: 1;
                transform: rotateY(0) scale(1);
            }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.05); opacity: 0.8; }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes modalFadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes modalSlideIn {
            to { transform: scale(1); }
        }

        @keyframes contextMenuIn {
            from {
                opacity: 0;
                transform: scale(0.8);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        @keyframes notificationIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes notificationOut {
            to {
                transform: translateX(100%);
                opacity: 0;
            }
        }

        /* === Cursor Styles === */
        body {
            cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><circle cx="8" cy="8" r="6" fill="%236366f1" opacity="0.8"/></svg>') 8 8, auto;
        }

        .workspace {
            cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="%236366f1" d="M13,2L3,14H12L11,22L21,10H12L13,2Z"/></svg>') 12 12, grab;
        }

        .workspace.dragging {
            cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="%23ef4444" d="M13,2L3,14H12L11,22L21,10H12L13,2Z"/></svg>') 12 12, grabbing;
        }

        .workspace.connecting {
            cursor: crosshair;
        }

        .entity, .relationship {
            cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20"><circle cx="10" cy="10" r="8" fill="%2310b981" opacity="0.8"/></svg>') 10 10, move;
        }

        .connection-dot {
            cursor: crosshair;
        }

        /* === Responsive Design === */
        @media (max-width: 1200px) {
            .container {
                grid-template-columns: 280px 1fr;
                gap: var(--space-md);
                padding: 0 var(--space-md);
            }
            
            .toolbar {
                padding: var(--space-md);
            }
        }

        @media (max-width: 768px) {
            .container {
                grid-template-columns: 1fr;
                gap: var(--space-md);
            }
            
            .toolbar {
                order: 2;
            }
            
            .workspace-container {
                order: 1;
            }
            
            .schema-panel {
                width: 100%;
                right: -100%;
            }
            
            .header-content {
                flex-direction: column;
                gap: var(--space-md);
                text-align: center;
            }
            
            .tool-grid {
                grid-template-columns: 1fr;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 0 var(--space-sm);
            }
            
            header {
                margin: var(--space-sm);
                padding: var(--space-md);
            }
            
            .logo-text h1 {
                font-size: 1.4rem;
            }
            
            .workspace {
                height: 500px;
            }
        }

        /* === Custom Scrollbar === */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-tertiary);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary-dark);
        }

        /* === Selection Styles === */
        ::selection {
            background: rgba(99, 102, 241, 0.3);
            color: var(--text-primary);
        }

        ::-moz-selection {
            background: rgba(99, 102, 241, 0.3);
            color: var(--text-primary);
        }

        /* === Focus Styles === */
        *:focus {
            outline: 2px solid var(--primary);
            outline-offset: 2px;
        }

        /* === Loading States === */
        .loading {
            position: relative;
            overflow: hidden;
        }

        .loading::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: loading 1.5s infinite;
        }

        @keyframes loading {
            100% {
                left: 100%;
            }
        }

        /* === Print Styles === */
        @media print {
            .toolbar,
            .workspace-controls,
            .schema-panel,
            footer {
                display: none !important;
            }
            
            .workspace-container {
                box-shadow: none;
                border: 1px solid #ccc;
            }
            
            .workspace {
                height: auto;
                min-height: 500px;
            }
        }
    </style>
</head>
<body class="light-mode">
    <!-- Animated Background -->
    <div class="animated-bg"></div>
    
    <!-- Header -->
    <header class="glass">
        <div class="header-content">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-project-diagram"></i>
                </div>
                <div class="logo-text">
                    <h1>ER/EER Diagram Builder Pro</h1>
                    <p>Professional Database Design Studio</p>
                </div>
            </div>
            <div class="header-controls">
                <button id="themeToggle" class="control-btn glass">
                    <i class="fas fa-moon"></i>
                    <span>Theme</span>
                </button>
                <button id="howToUseBtn" class="control-btn glass">
                    <i class="fas fa-info-circle"></i>
                    <span>How to Use</span>
                </button>
            </div>
        </div>
    </header>

    <main class="container">
        <!-- Sidebar Toolbar -->
        <nav class="toolbar glass">
            <!-- Entities Section -->
            <section class="tool-section">
                <div class="section-header">
                    <i class="fas fa-shapes"></i>
                    <h3>Entities & Attributes</h3>
                </div>
                <div class="tool-grid">
                    <button class="tool-btn" data-tool="entity">
                        <div class="tool-icon">
                            <i class="fas fa-cube"></i>
                        </div>
                        <span>Entity</span>
                    </button>
                    <button class="tool-btn" data-tool="weak-entity">
                        <div class="tool-icon">
                            <i class="fas fa-cube"></i>
                            <i class="fas fa-link weak-overlay"></i>
                        </div>
                        <span>Weak Entity</span>
                    </button>
                    <button class="tool-btn" data-tool="attribute">
                        <div class="tool-icon">
                            <i class="fas fa-tag"></i>
                        </div>
                        <span>Attribute</span>
                    </button>
                    <button class="tool-btn" data-tool="composite">
                        <div class="tool-icon">
                            <i class="fas fa-tags"></i>
                        </div>
                        <span>Composite</span>
                    </button>
                    <button class="tool-btn" data-tool="multivalued">
                        <div class="tool-icon">
                            <i class="fas fa-list"></i>
                        </div>
                        <span>Multivalued</span>
                    </button>
                    <button class="tool-btn" data-tool="derived">
                        <div class="tool-icon">
                            <i class="fas fa-calculator"></i>
                        </div>
                        <span>Derived</span>
                    </button>
                    <button class="tool-btn" data-tool="relationship">
                        <div class="tool-icon">
                            <i class="fas fa-arrows-alt-h"></i>
                        </div>
                        <span>Relationship</span>
                    </button>
                </div>
            </section>

            <!-- Actions Section -->
            <section class="tool-section">
                <div class="section-header">
                    <i class="fas fa-tools"></i>
                    <h3>Actions</h3>
                </div>
                <div class="action-grid">
                    <button class="action-btn danger" id="clearBtn">
                        <i class="fas fa-broom"></i>
                        <span>Clear Canvas</span>
                    </button>
                    <button class="action-btn primary" id="saveBtn">
                        <i class="fas fa-save"></i>
                        <span>Save Diagram</span>
                    </button>
                    <button class="action-btn secondary" id="loadBtn">
                        <i class="fas fa-folder-open"></i>
                        <span>Load Diagram</span>
                    </button>
                    <button class="action-btn success" id="exportBtn">
                        <i class="fas fa-download"></i>
                        <span>Export Image</span>
                    </button>
                    <button class="action-btn accent" id="generateSchemaBtn">
                        <i class="fas fa-database"></i>
                        <span>Generate Schema</span>
                    </button>
                </div>
            </section>

            <!-- Statistics -->
            <section class="tool-section stats">
                <div class="section-header">
                    <i class="fas fa-chart-bar"></i>
                    <h3>Statistics</h3>
                </div>
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-icon">
                            <i class="fas fa-cube"></i>
                        </div>
                        <div class="stat-info">
                            <span class="stat-value" id="entityCount">0</span>
                            <span class="stat-label">Entities</span>
                        </div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-icon">
                            <i class="fas fa-link"></i>
                        </div>
                        <div class="stat-info">
                            <span class="stat-value" id="relationshipCount">0</span>
                            <span class="stat-label">Relationships</span>
                        </div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-icon">
                            <i class="fas fa-project-diagram"></i>
                        </div>
                        <div class="stat-info">
                            <span class="stat-value" id="connectionCount">0</span>
                            <span class="stat-label">Connections</span>
                        </div>
                    </div>
                </div>
            </section>
        </nav>

        <!-- Main Workspace -->
        <div class="workspace-container glass">
            <div class="workspace-controls">
                <div class="control-group">
                    <button id="zoomIn" class="control-btn glass" title="Zoom In">
                        <i class="fas fa-search-plus"></i>
                    </button>
                    <button id="zoomOut" class="control-btn glass" title="Zoom Out">
                        <i class="fas fa-search-minus"></i>
                    </button>
                    <button id="resetView" class="control-btn glass" title="Reset View">
                        <i class="fas fa-expand-arrows-alt"></i>
                    </button>
                    <button id="gridToggle" class="control-btn glass active" title="Toggle Grid">
                        <i class="fas fa-th"></i>
                    </button>
                </div>
                <div class="zoom-display glass">
                    <span id="zoomLevel">100%</span>
                </div>
            </div>

            <div class="workspace" id="workspace">
                <div class="workspace-info" id="workspaceInfo">
                    <div class="info-graphic">
                        <div class="graphic-element">
                            <i class="fas fa-mouse-pointer"></i>
                        </div>
                        <div class="graphic-orbits">
                            <div class="orbit"></div>
                            <div class="orbit"></div>
                            <div class="orbit"></div>
                        </div>
                    </div>
                    <h2>Welcome to ER Diagram Builder Pro</h2>
                    <p>Start designing your database schema by dragging elements from the toolbar</p>
                    
                    <div class="info-features">
                        <div class="feature">
                            <i class="fas fa-magic"></i>
                            <div>
                                <strong>Smart Connections</strong>
                                <span>Drag from connection points to link entities</span>
                            </div>
                        </div>
                        <div class="feature">
                            <i class="fas fa-edit"></i>
                            <div>
                                <strong>Double Click to Edit</strong>
                                <span>Customize properties of any element</span>
                            </div>
                        </div>
                        <div class="feature">
                            <i class="fas fa-bolt"></i>
                            <div>
                                <strong>Auto Schema Generation</strong>
                                <span>Convert ER diagrams to relational schema</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <svg class="connection-layer" id="connectionLayer"></svg>
            </div>
        </div>
    </main>

    <!-- Schema Panel -->
    <aside class="schema-panel glass" id="schemaPanel">
        <div class="schema-header">
            <div class="schema-title">
                <i class="fas fa-table"></i>
                <h3>Generated Relational Schema</h3>
            </div>
            <div class="schema-controls">
                <button id="copySchemaBtn" class="control-btn glass" title="Copy Schema">
                    <i class="fas fa-copy"></i>
                </button>
                <button id="closeSchemaBtn" class="control-btn glass" title="Close Panel">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
        <div class="schema-content" id="schemaContent">
            <!-- Schema content will be generated here -->
        </div>
    </aside>

    <!-- Modals -->
    <!-- How to Use Modal -->
    <div class="modal" id="howToUseModal">
        <div class="modal-content glass">
            <div class="modal-header">
                <div class="modal-title">
                    <i class="fas fa-info-circle"></i>
                    <h3>How to Use ER/EER Diagram Builder Pro</h3>
                </div>
                <button class="close-btn glass" id="closeHowToUseModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <ol style="padding-left: 1.2em;">
                    <li><strong>Select a Tool:</strong> Use the toolbar on the left to select Entity, Weak Entity, Attribute, Composite, Multivalued, or Derived Attribute.</li>
                    <li><strong>Add Elements:</strong> Click on the canvas to add the selected element. For attributes, select an entity first.</li>
                    <li><strong>Edit Properties:</strong> Double-click any element to edit its properties, name, or attributes.</li>
                    <li><strong>Connect Entities:</strong> Use the connection dots to create relationships between entities (if enabled).</li>
                    <li><strong>Move Elements:</strong> Drag elements to reposition them on the canvas.</li>
                    <li><strong>Actions:</strong> Use the sidebar buttons to clear the canvas, save/load diagrams, export images, or generate the relational schema.</li>
                    <li><strong>Theme & Grid:</strong> Toggle between light/dark mode and show/hide the grid for better visibility.</li>
                    <li><strong>Statistics:</strong> View real-time counts of entities, relationships, and connections in the sidebar.</li>
                    <li><strong>Schema Panel:</strong> Click 'Generate Schema' to view the SQL schema for your diagram. You can copy or close the panel.</li>
                </ol>
                <p style="margin-top:1em; color:#6366f1;"><strong>Tip:</strong> Right-click elements for quick actions like edit, delete, or view properties.</p>
            </div>
        </div>
    </div>

    <div class="modal" id="entityModal">
        <div class="modal-content glass">
            <div class="modal-header">
                <div class="modal-title">
                    <i class="fas fa-cube"></i>
                    <h3>Entity Properties</h3>
                </div>
                <button class="close-btn glass" id="closeEntityModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="entityName">Entity Name</label>
                    <input type="text" id="entityName" class="glass" placeholder="e.g., Student, Course">
                </div>
                <div class="form-group">
                    <label>Attributes</label>
                    <div id="attributesList" class="attributes-list"></div>
                    <button class="add-btn glass" id="addAttributeBtn">
                        <i class="fas fa-plus-circle"></i>
                        Add Attribute
                    </button>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn secondary glass" id="cancelEntityBtn">Cancel</button>
                <button class="btn primary" id="saveEntityBtn">Save Changes</button>
            </div>
        </div>
    </div>

    <!-- Relationship Modal -->
    <div class="modal" id="relationshipModal">
        <div class="modal-content glass">
            <div class="modal-header">
                <div class="modal-title">
                    <i class="fas fa-link"></i>
                    <h3>Relationship Properties</h3>
                </div>
                <button class="close-btn glass" id="closeRelationshipModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="relationshipName">Relationship Name</label>
                    <input type="text" id="relationshipName" class="glass" placeholder="e.g., Enrolls, Teaches">
                </div>
                <div class="form-group">
                    <label for="relationshipType">Relationship Type</label>
                    <select id="relationshipType" class="glass">
                        <option value="regular">Regular</option>
                        <option value="identifying">Identifying</option>
                        <option value="isa">ISA (Inheritance)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="relationshipEntities">Entities Involved</label>
                    <input type="text" id="relationshipEntities" class="glass" placeholder="e.g., Student, Course, Teacher (comma separated)">
                </div>
                <div class="form-group">
                    <label for="relationshipCardinality">Cardinality</label>
                    <select id="relationshipCardinality" class="glass">
                        <option value="1:1">1:1</option>
                        <option value="1:N">1:N</option>
                        <option value="N:1">N:1</option>
                        <option value="M:N">M:N</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="relationshipParticipation">Participation</label>
                    <select id="relationshipParticipation" class="glass">
                        <option value="partial">Partial</option>
                        <option value="total">Total</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn secondary glass" id="cancelRelationshipBtn">Cancel</button>
                <button class="btn primary" id="saveRelationshipBtn">Save Changes</button>
            </div>
        </div>
    </div>

    <div class="modal" id="attributeModal">
        <div class="modal-content glass">
            <div class="modal-header">
                <div class="modal-title">
                    <i class="fas fa-tag"></i>
                    <h3>Attribute Properties</h3>
                </div>
                <button class="close-btn glass" id="closeAttributeModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="attributeName">Attribute Name</label>
                    <input type="text" id="attributeName" class="glass" placeholder="e.g., ID, Name, Email">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="attributeType">Attribute Type</label>
                        <select id="attributeType" class="glass">
                            <option value="simple">Simple</option>
                            <option value="composite">Composite</option>
                            <option value="multivalued">Multivalued</option>
                            <option value="derived">Derived</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="dataType">Data Type</label>
                        <select id="dataType" class="glass">
                            <option value="VARCHAR(255)">VARCHAR(255)</option>
                            <option value="INT">INT</option>
                            <option value="DATE">DATE</option>
                            <option value="DECIMAL">DECIMAL</option>
                            <option value="BOOLEAN">BOOLEAN</option>
                        </select>
                    </div>
                </div>
                <div class="composite-group" id="compositeAttributes" style="display: none;">
                    <label>Composite Sub-attributes</label>
                    <div id="compositeAttributesList" class="sub-attributes-list"></div>
                    <button class="add-btn glass" id="addCompositeAttrBtn">
                        <i class="fas fa-plus-circle"></i>
                        Add Sub-attribute
                    </button>
                </div>
                <div class="checkbox-group">
                    <label class="checkbox">
                        <input type="checkbox" id="isKey">
                        <span class="checkmark"></span>
                        Primary Key
                    </label>
                    <label class="checkbox">
                        <input type="checkbox" id="isNullable" checked>
                        <span class="checkmark"></span>
                        Nullable
                    </label>
                    <label class="checkbox">
                        <input type="checkbox" id="isUnique">
                        <span class="checkmark"></span>
                        Unique
                    </label>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn secondary glass" id="cancelAttributeBtn">Cancel</button>
                <button class="btn primary" id="saveAttributeBtn">Save Attribute</button>
            </div>
        </div>
    </div>

    <!-- Context Menu -->
    <div class="context-menu glass" id="contextMenu">
        <div class="context-item" data-action="edit">
            <i class="fas fa-edit"></i>
            <span>Edit</span>
        </div>
        <div class="context-item" data-action="delete">
            <i class="fas fa-trash"></i>
            <span>Delete</span>
        </div>
        <div class="context-item" data-action="properties">
            <i class="fas fa-cog"></i>
            <span>Properties</span>
        </div>
    </div>

    <!-- Notification System -->
    <div class="notification-container" id="notificationContainer"></div>

    <footer class="glass">
        <div class="footer-content">
            <div class="footer-info">
                <p>ER/EER Diagram Builder Pro &copy; 2024</p>
                <p>Professional Database Design Studio</p>
            </div>
            <div class="footer-links">
                <p class="footer-fas fa-heart pulse">© 2024 NeoDBMS | Architected with 💙 by JavaPyWizard</p>
            </div>
        </div>
    </footer>

    <script>
        // Application state
        let entities = [];
        let attributes = [];
        let relationships = [];
        let currentElement = null;
        let selectedElement = null;
        let draggedElement = null;
        let offsetX = 0, offsetY = 0;
        let isDarkMode = false;

        // DOM Elements
        const canvas = document.getElementById('workspace');
        const connectionsSvg = document.getElementById('connectionLayer');

        // Initialize the application
        document.addEventListener('DOMContentLoaded', () => {
            initializeEventListeners();
            updateStats();
            hideWorkspaceInfo();
        });

        function initializeEventListeners() {
            // Tool selection
            document.querySelectorAll('.tool-btn[data-tool]').forEach((btn) => {
                btn.addEventListener('click', (e) => {
                    selectTool(e.currentTarget.dataset.tool);
                    updateToolButtons(e.currentTarget);
                });
            });

            // Action buttons
            document.getElementById('clearBtn').addEventListener('click', () => clearCanvas());
            document.getElementById('saveBtn').addEventListener('click', () => saveDiagram());
            document.getElementById('loadBtn').addEventListener('click', () => loadDiagram());
            document.getElementById('exportBtn').addEventListener('click', () => exportDiagram());
            document.getElementById('generateSchemaBtn').addEventListener('click', () => generateSchema());

            // Workspace controls
            document.getElementById('zoomIn').addEventListener('click', () => zoom(0.1));
            document.getElementById('zoomOut').addEventListener('click', () => zoom(-0.1));
            document.getElementById('resetView').addEventListener('click', () => resetView());
            document.getElementById('gridToggle').addEventListener('click', (e) => toggleGrid(e.currentTarget));

            // Schema panel
            document.getElementById('closeSchemaBtn').addEventListener('click', () => closeSchemaPanel());
            document.getElementById('copySchemaBtn').addEventListener('click', () => copySchema());

            // Theme toggle
            document.getElementById('themeToggle').addEventListener('click', () => toggleTheme());

            // Workspace events
            canvas.addEventListener('mousedown', (e) => handleWorkspaceMouseDown(e));
            canvas.addEventListener('mousemove', (e) => handleWorkspaceMouseMove(e));
            canvas.addEventListener('mouseup', (e) => handleWorkspaceMouseUp(e));
            canvas.addEventListener('dblclick', (e) => handleWorkspaceDoubleClick(e));
            canvas.addEventListener('contextmenu', (e) => handleWorkspaceContextMenu(e));

            // Modal events
            initModalEvents();

            // Keyboard events
            document.addEventListener('keydown', (e) => handleKeyDown(e));

            // Context menu events
            document.addEventListener('click', () => hideContextMenu());
            document.getElementById('contextMenu').addEventListener('click', (e) => handleContextMenuAction(e));

            // Prevent default drag behavior
            canvas.addEventListener('dragstart', (e) => e.preventDefault());

            // How to Use Modal
            document.getElementById('howToUseBtn').addEventListener('click', () => {
                document.getElementById('howToUseModal').classList.add('open');
            });
            document.getElementById('closeHowToUseModal').addEventListener('click', () => {
                document.getElementById('howToUseModal').classList.remove('open');
            });
        }

        function initModalEvents() {
            // Entity modal
            document.getElementById('closeEntityModal').addEventListener('click', () => closeEntityModal());
            document.getElementById('saveEntityBtn').addEventListener('click', () => saveEntity());
            document.getElementById('cancelEntityBtn').addEventListener('click', () => closeEntityModal());
            document.getElementById('addAttributeBtn').addEventListener('click', () => openAttributeModal());

            // Relationship modal
            document.getElementById('closeRelationshipModal').addEventListener('click', () => closeRelationshipModal());
            document.getElementById('saveRelationshipBtn').addEventListener('click', () => saveRelationshipModal());
            document.getElementById('cancelRelationshipBtn').addEventListener('click', () => closeRelationshipModal());

            // Attribute modal
            document.getElementById('closeAttributeModal').addEventListener('click', () => closeAttributeModal());
            document.getElementById('saveAttributeBtn').addEventListener('click', () => saveAttribute());
            document.getElementById('cancelAttributeBtn').addEventListener('click', () => closeAttributeModal());
            document.getElementById('addCompositeAttrBtn').addEventListener('click', () => addCompositeAttribute());
            document.getElementById('attributeType').addEventListener('change', (e) => toggleCompositeAttributes(e.target.value));
        }

        // === Tool Selection ===
        function selectTool(tool) {
            const toolNames = {
                entity: "Entity",
                "weak-entity": "Weak Entity",
                attribute: "Attribute",
                composite: "Composite Attribute",
                multivalued: "Multivalued Attribute",
                derived: "Derived Attribute",
                relationship: "Relationship"
            };
            
            showNotification(`Selected: ${toolNames[tool] || tool}`, "info");
        }

        function updateToolButtons(activeBtn) {
            document.querySelectorAll('.tool-btn').forEach((btn) => {
                btn.classList.remove('active');
            });
            activeBtn.classList.add('active');
        }

        // === Workspace Event Handlers ===
        function handleWorkspaceMouseDown(e) {
            if (e.button !== 0) return; // Only left click

            const target = e.target.closest('.entity, .relationship, .connection-dot');

            if (target) {
                if (target.classList.contains('connection-dot')) {
                    // Connection logic would go here
                } else {
                    startDragging(target, e);
                    selectElement(target);
                }
            } else {
                // Create new element if a tool is selected
                const activeTool = document.querySelector('.tool-btn.active');
                if (activeTool) {
                    createNewElement(e, activeTool.dataset.tool);
                } else {
                    deselectAll();
                }
            }
        }

        function handleWorkspaceMouseMove(e) {
            if (draggedElement) {
                const rect = canvas.getBoundingClientRect();
                const x = e.clientX - rect.left - offsetX;
                const y = e.clientY - rect.top - offsetY;

                draggedElement.style.left = `${x}px`;
                draggedElement.style.top = `${y}px`;

                // Update element position in data model
                updateElementPosition(draggedElement.id, x, y);
            }
        }

        function handleWorkspaceMouseUp(e) {
            draggedElement = null;
        }

        function handleWorkspaceDoubleClick(e) {
            const target = e.target.closest('.entity, .relationship');
            if (target) {
                if (target.classList.contains('entity')) {
                    const entity = entities.find((ent) => ent.id === target.id);
                    if (entity) openEntityModal(entity);
                } else if (target.classList.contains('relationship')) {
                    const relationship = relationships.find((rel) => rel.id === target.id);
                    if (relationship) openRelationshipModal(relationship);
                }
            }
        }

        function handleWorkspaceContextMenu(e) {
            e.preventDefault();
            const target = e.target.closest('.entity, .relationship');
            if (target) {
                selectElement(target);
                showContextMenu(e.clientX, e.clientY);
            } else {
                hideContextMenu();
                deselectAll();
            }
        }

        function handleKeyDown(e) {
            if (e.key === 'Delete' && selectedElement) {
                deleteElement(selectedElement);
            } else if (e.key === 'Escape') {
                deselectAll();
                hideContextMenu();
            }
        }

        // === Element Selection ===
        function selectElement(element) {
            deselectAll();
            selectedElement = element;
            element.classList.add('selected');
        }

        function deselectAll() {
            document.querySelectorAll('.entity, .relationship').forEach((el) => {
                el.classList.remove('selected');
            });
            selectedElement = null;
        }

        // === Element Creation ===
        function createNewElement(e, toolType) {
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left - 100;
            const y = e.clientY - rect.top - 50;

            switch (toolType) {
                case 'entity':
                    createEntity(x, y);
                    break;
                case 'weak-entity':
                    createWeakEntity(x, y);
                    break;
                case 'relationship':
                    createRelationship(x, y);
                    break;
                case 'attribute':
                    showNotification("Select an entity to add attributes", "info");
                    break;
                default:
                    // For other attribute types
                    showNotification("Select an entity to add attributes", "info");
                    break;
            }
        }

        function createEntity(x, y, data = {}) {
            const entityId = `entity-${Date.now()}`;
            const entity = {
                id: entityId,
                name: data.name || "New Entity",
                type: "regular",
                x: x,
                y: y,
                attributes: data.attributes || [],
            };

            entities.push(entity);
            renderEntity(entity);
            updateStats();

            if (!data.name) {
                openEntityModal(entity);
            }

            return entity;
        }

        function createWeakEntity(x, y, data = {}) {
            const entityId = `entity-${Date.now()}`;
            const entity = {
                id: entityId,
                name: data.name || "Weak Entity",
                type: "weak",
                x: x,
                y: y,
                attributes: data.attributes || [],
                identifyingRelationship: null,
            };

            entities.push(entity);
            renderEntity(entity);
            updateStats();

            if (!data.name) {
                openEntityModal(entity);
            }

            return entity;
        }

        function renderEntity(entity) {
            const entityEl = document.createElement('div');
            entityEl.className = `entity ${entity.type === 'weak' ? 'weak-entity' : ''}`;
            entityEl.id = entity.id;
            entityEl.style.left = `${entity.x}px`;
            entityEl.style.top = `${entity.y}px`;

            let attributesHtml = '';
            entity.attributes.forEach((attr) => {
                const attrClass = attr.isKey ? 'key' : attr.type;
                attributesHtml += `<div class="attribute ${attrClass}">${attr.name}</div>`;
            });

            entityEl.innerHTML = `
                <div class="entity-header">
                    ${entity.name}
                    <div class="entity-actions">
                        <button class="entity-action" onclick="editElement('${entity.id}')">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="entity-action" onclick="deleteElement('${entity.id}')">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
                <div class="entity-attributes">${attributesHtml}</div>
                <div class="connection-points">
                    <div class="connection-dot" data-entity="${entity.id}"></div>
                </div>
            `;

            canvas.appendChild(entityEl);
            addElementEventListeners(entityEl);
            hideWorkspaceInfo();
        }

        function createRelationship(x, y, data = {}) {
            const relationshipId = `relationship-${Date.now()}`;
            const relationship = {
                id: relationshipId,
                name: data.name || "Relates",
                type: data.type || "regular",
                x: x,
                y: y,
                cardinality: data.cardinality || "1:1",
                participation: data.participation || "partial",
                entities: data.entities || []
            };

            relationships.push(relationship);
            renderRelationship(relationship);
            updateStats();

            if (!data.name) {
                openRelationshipModal(relationship);
            }

            return relationship;
        }

        function renderRelationship(relationship) {
            const relationshipEl = document.createElement('div');
            relationshipEl.className = `relationship ${relationship.type === 'isa' ? 'isa-relationship' : ''} ${relationship.type === 'identifying' ? 'identifying' : ''}`;
            relationshipEl.id = relationship.id;
            relationshipEl.style.left = `${relationship.x}px`;
            relationshipEl.style.top = `${relationship.y}px`;
            relationshipEl.textContent = relationship.name;

            canvas.appendChild(relationshipEl);
            addElementEventListeners(relationshipEl);
            hideWorkspaceInfo();
        }

        function addElementEventListeners(element) {
            element.addEventListener('dblclick', () => editElement(element.id));
            element.addEventListener('mousedown', (e) => {
                if (e.button === 0) {
                    startDragging(element, e);
                    selectElement(element);
                }
            });
        }

        // === Element Management ===
        function startDragging(element, e) {
            draggedElement = element;

            const rect = element.getBoundingClientRect();
            const workspaceRect = canvas.getBoundingClientRect();

            offsetX = e.clientX - rect.left;
            offsetY = e.clientY - rect.top;

            element.style.zIndex = 1000;
        }

        function updateElementPosition(elementId, x, y) {
            // Update entity position
            let entity = entities.find((ent) => ent.id === elementId);
            if (entity) {
                entity.x = x;
                entity.y = y;
                return;
            }

            // Update relationship position
            let relationship = relationships.find((rel) => rel.id === elementId);
            if (relationship) {
                relationship.x = x;
                relationship.y = y;
            }
        }

        function editElement(elementId) {
            const entity = entities.find((ent) => ent.id === elementId);
            if (entity) {
                openEntityModal(entity);
                return;
            }

            const relationship = relationships.find((rel) => rel.id === elementId);
            if (relationship) {
                openRelationshipModal(relationship);
            }
        }

        function deleteElement(elementId) {
            const element = document.getElementById(elementId);
            if (!element) return;

            if (element.classList.contains('entity')) {
                entities = entities.filter((ent) => ent.id !== elementId);
            } else if (element.classList.contains('relationship')) {
                relationships = relationships.filter((rel) => rel.id !== elementId);
            }

            element.style.animation = 'flipIn 0.6s ease reverse';
            setTimeout(() => {
                element.remove();
                updateStats();
                showNotification('Element deleted', 'info');
            }, 300);
        }

        // === Modal Management ===
        function openEntityModal(entity) {
            currentElement = entity;
            document.getElementById('entityName').value = entity.name;
            renderAttributesList();
            document.getElementById('entityModal').classList.add('open');
        }

        function closeEntityModal() {
            document.getElementById('entityModal').classList.remove('open');
            currentElement = null;
        }

        function openRelationshipModal(relationship) {
            currentElement = relationship;
            document.getElementById('relationshipName').value = relationship.name;
            document.getElementById('relationshipType').value = relationship.type;
            document.getElementById('relationshipModal').classList.add('open');
        }

        function closeRelationshipModal() {
            document.getElementById('relationshipModal').classList.remove('open');
            currentElement = null;
        }

        function openAttributeModal(attribute = null) {
            currentElement = attribute;

            if (attribute) {
                document.getElementById('attributeName').value = attribute.name;
                document.getElementById('attributeType').value = attribute.type;
                document.getElementById('dataType').value = attribute.dataType;
                document.getElementById('isKey').checked = attribute.isKey;
                document.getElementById('isNullable').checked = attribute.isNullable;
                document.getElementById('isUnique').checked = attribute.isUnique;
            } else {
                document.getElementById('attributeName').value = '';
                document.getElementById('attributeType').value = 'simple';
                document.getElementById('dataType').value = 'VARCHAR(255)';
                document.getElementById('isKey').checked = false;
                document.getElementById('isNullable').checked = true;
                document.getElementById('isUnique').checked = false;
            }

            toggleCompositeAttributes(document.getElementById('attributeType').value);
            document.getElementById('attributeModal').classList.add('open');
        }

        function closeAttributeModal() {
            document.getElementById('attributeModal').classList.remove('open');
            currentElement = null;
        }

        function renderAttributesList() {
            const attributesList = document.getElementById('attributesList');
            attributesList.innerHTML = '';

            currentElement.attributes.forEach((attr, index) => {
                const attrItem = document.createElement('div');
                attrItem.className = 'attribute-item';
                attrItem.innerHTML = `
                    <span>${attr.name} (${attr.type})${attr.isKey ? ' 🔑' : ''}</span>
                    <div>
                        <button class="delete-attr" onclick="editAttribute(${index})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="delete-attr" onclick="deleteAttribute(${index})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                attributesList.appendChild(attrItem);
            });
        }

        function toggleCompositeAttributes(type) {
            const compositeContainer = document.getElementById('compositeAttributes');
            compositeContainer.style.display = type === 'composite' ? 'block' : 'none';
        }

        // === Data Management ===
        function saveEntity() {
            const name = document.getElementById('entityName').value.trim();
            if (!name) {
                showNotification('Please enter an entity name', 'error');
                return;
            }

            currentElement.name = name;

            const entityEl = document.getElementById(currentElement.id);
            if (entityEl) {
                entityEl.querySelector('.entity-header').firstChild.textContent = name;

                let attributesHtml = '';
                currentElement.attributes.forEach((attr) => {
                    const attrClass = attr.isKey ? 'key' : attr.type;
                    attributesHtml += `<div class="attribute ${attrClass}">${attr.name}</div>`;
                });

                entityEl.querySelector('.entity-attributes').innerHTML = attributesHtml;
            }

            closeEntityModal();
            showNotification('Entity saved successfully', 'success');
        }

        function saveRelationshipModal() {
            const name = document.getElementById('relationshipName').value.trim();
            if (!name) {
                showNotification('Please enter a relationship name', 'error');
                return;
            }
            const type = document.getElementById('relationshipType').value;

            currentElement.name = name;
            currentElement.type = type;

            const relationshipEl = document.getElementById(currentElement.id);
            if (relationshipEl) {
                relationshipEl.textContent = name;
                relationshipEl.className = `relationship ${type === 'isa' ? 'isa-relationship' : ''} ${type === 'identifying' ? 'identifying' : ''}`;
            }

            closeRelationshipModal();
            showNotification('Relationship saved successfully', 'success');
        }

        function saveAttribute() {
            const name = document.getElementById('attributeName').value.trim();
            if (!name) {
                showNotification('Please enter an attribute name', 'error');
                return;
            }

            const type = document.getElementById('attributeType').value;
            const dataType = document.getElementById('dataType').value;
            const isKey = document.getElementById('isKey').checked;
            const isNullable = document.getElementById('isNullable').checked;
            const isUnique = document.getElementById('isUnique').checked;

            const attribute = {
                name: name,
                type: type,
                dataType: dataType,
                isKey: isKey,
                isNullable: isNullable,
                isUnique: isUnique,
            };

            if (currentElement) {
                // Update existing attribute
                const index = currentElement.attributes.indexOf(currentElement);
                currentElement.attributes[index] = attribute;
            } else {
                // Add new attribute
                currentElement.attributes.push(attribute);
            }

            renderAttributesList();
            closeAttributeModal();
            showNotification('Attribute saved successfully', 'success');
        }

        function addCompositeAttribute() {
            showNotification('Add sub-attributes for composite attribute', 'info');
        }

        function editAttribute(index) {
            const attribute = currentElement.attributes[index];
            openAttributeModal(attribute);
        }

        function deleteAttribute(index) {
            currentElement.attributes.splice(index, 1);
            renderAttributesList();
            showNotification('Attribute deleted', 'info');
        }

        // === Workspace Management ===
        function clearCanvas() {
            if (confirm('Are you sure you want to clear the entire workspace? This action cannot be undone.')) {
                canvas.querySelectorAll('.entity, .relationship').forEach((el) => {
                    el.style.animation = 'flipIn 0.6s ease reverse';
                    setTimeout(() => el.remove(), 300);
                });

                connectionsSvg.innerHTML = '';
                entities = [];
                relationships = [];
                updateStats();
                showNotification('Workspace cleared', 'info');
            }
        }

        function saveDiagram() {
            const diagramData = {
                entities: entities,
                relationships: relationships,
                timestamp: new Date().toISOString(),
                version: '1.0',
            };

            const dataStr = JSON.stringify(diagramData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });

            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `er-diagram-${Date.now()}.json`;
            link.click();

            URL.revokeObjectURL(url);
            showNotification('Diagram saved successfully', 'success');
        }

        function loadDiagram() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';

            input.onchange = (e) => {
                const file = e.target.files[0];
                if (!file) return;

                const reader = new FileReader();
                reader.onload = (event) => {
                    try {
                        const diagramData = JSON.parse(event.target.result);
                        loadDiagramData(diagramData);
                        showNotification('Diagram loaded successfully', 'success');
                    } catch (error) {
                        showNotification('Error loading diagram file', 'error');
                    }
                };
                reader.readAsText(file);
            };

            input.click();
        }

        function loadDiagramData(diagramData) {
            clearCanvas();

            entities = diagramData.entities || [];
            relationships = diagramData.relationships || [];

            entities.forEach((entity) => renderEntity(entity));
            relationships.forEach((relationship) => renderRelationship(relationship));
            updateStats();
            hideWorkspaceInfo();
        }

        function exportDiagram() {
            showNotification('Exporting diagram as image...', 'info');
            // In a real implementation, this would use html2canvas or similar
            setTimeout(() => {
                showNotification('Diagram exported successfully', 'success');
            }, 1000);
        }

        // === Schema Generation ===
        function generateSchema() {
            const schemaContent = document.getElementById('schemaContent');
            schemaContent.innerHTML = '';

            if (entities.length === 0) {
                schemaContent.innerHTML = `
                    <div class="no-schema">
                        <i class="fas fa-database"></i>
                        <h3>No Entities Found</h3>
                        <p>Add entities to your diagram to generate a relational schema</p>
                    </div>
                `;
            } else {
                entities.forEach((entity) => {
                    const tableSchema = generateTableSchema(entity);
                    schemaContent.appendChild(tableSchema);
                });
            }

            document.getElementById('schemaPanel').classList.add('open');
            showNotification('Relational schema generated', 'success');
        }

        function generateTableSchema(entity) {
            const tableSchema = document.createElement('div');
            tableSchema.className = 'table-schema';

            let attributesHtml = '';
            let primaryKeys = [];

            entity.attributes.forEach((attr) => {
                const attrClass = attr.isKey ? 'pk' : '';
                const constraints = [];

                if (attr.isKey) primaryKeys.push(attr.name);
                if (!attr.isNullable) constraints.push('NOT NULL');
                if (attr.isUnique) constraints.push('UNIQUE');

                attributesHtml += `
                    <div class="attribute-schema ${attrClass}">
                        <span>${attr.name}</span>
                        <div>
                            <span>${attr.dataType}</span>
                            ${constraints.length > 0 ? `<span class="constraints">${constraints.join(', ')}</span>` : ''}
                        </div>
                    </div>
                `;
            });

            tableSchema.innerHTML = `
                <div class="table-name">
                    <i class="fas fa-table"></i>
                    ${entity.name}
                </div>
                ${attributesHtml}
                ${primaryKeys.length > 0 ? `
                    <div class="attribute-schema pk">
                        <span>PRIMARY KEY (${primaryKeys.join(', ')})</span>
                        <span></span>
                    </div>
                ` : ''}
            `;

            return tableSchema;
        }

        function closeSchemaPanel() {
            document.getElementById('schemaPanel').classList.remove('open');
        }

        function copySchema() {
            const schemaText = document.getElementById('schemaContent').innerText;
            navigator.clipboard.writeText(schemaText).then(() => {
                showNotification('Schema copied to clipboard', 'success');
            });
        }

        // === UI Controls ===
        function toggleTheme() {
            const body = document.body;
            const themeBtn = document.getElementById('themeToggle');

            if (body.classList.contains('light-mode')) {
                body.classList.replace('light-mode', 'dark-mode');
                themeBtn.innerHTML = '<i class="fas fa-sun"></i><span>Light Mode</span>';
                showNotification('Dark mode activated', 'info');
            } else {
                body.classList.replace('dark-mode', 'light-mode');
                themeBtn.innerHTML = '<i class="fas fa-moon"></i><span>Dark Mode</span>';
                showNotification('Light mode activated', 'info');
            }
        }

        function toggleGrid(btn) {
            btn.classList.toggle('active');
            canvas.classList.toggle('grid-enabled');
        }

        function zoom(delta) {
            // Zoom functionality would go here
            showNotification('Zoom functionality would be implemented here', 'info');
        }

        function resetView() {
            // Reset view functionality would go here
            showNotification('View reset', 'info');
        }

        // === Context Menu ===
        function showContextMenu(x, y) {
            const contextMenu = document.getElementById('contextMenu');
            contextMenu.style.left = `${x}px`;
            contextMenu.style.top = `${y}px`;
            contextMenu.classList.add('open');
        }

        function hideContextMenu() {
            document.getElementById('contextMenu').classList.remove('open');
        }

        function handleContextMenuAction(e) {
            const action = e.target.closest('.context-item')?.dataset.action;
            if (!action || !selectedElement) return;

            switch (action) {
                case 'edit':
                    editElement(selectedElement.id);
                    break;
                case 'delete':
                    deleteElement(selectedElement.id);
                    break;
                case 'properties':
                    showNotification('Properties feature coming soon', 'info');
                    break;
            }

            hideContextMenu();
        }

        // === Utility Methods ===
        function hideWorkspaceInfo() {
            if (entities.length > 0 || relationships.length > 0) {
                document.getElementById('workspaceInfo').style.display = 'none';
            }
        }

        function updateStats() {
            document.getElementById('entityCount').textContent = entities.length;
            document.getElementById('relationshipCount').textContent = relationships.length;
            document.getElementById('connectionCount').textContent = 0; // Simplified for this example
        }

        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <i class="fas fa-${getNotificationIcon(type)}"></i>
                <span>${message}</span>
            `;

            document.getElementById('notificationContainer').appendChild(notification);

            // Remove after 4 seconds
            setTimeout(() => {
                notification.classList.add('out');
                setTimeout(() => notification.remove(), 300);
            }, 4000);
        }

        function getNotificationIcon(type) {
            const icons = {
                success: 'check-circle',
                error: 'exclamation-circle',
                warning: 'exclamation-triangle',
                info: 'info-circle',
            };
            return icons[type] || 'info-circle';
        }
    </script>
</body>
</html>